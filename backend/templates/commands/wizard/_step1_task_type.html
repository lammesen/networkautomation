<!-- Step 1: Task Type Selection -->
<div class="space-y-4">
  <div class="flex items-center justify-between mb-4">
    <div>
      <h3 class="text-lg font-medium text-foreground">Select Task Type</h3>
      <p class="text-sm text-muted-foreground">Choose the automation library and task to run</p>
    </div>
    <span class="text-xs text-muted-foreground">Step 1 of 4</span>
  </div>

  <!-- Task Library Cards -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <!-- Napalm Card -->
    <button type="button" onclick="selectTaskType('napalm')" class="task-type-card group relative rounded-lg border-2 border-border bg-card p-4 text-left hover:border-primary hover:bg-accent transition-all">
      <div class="flex items-start gap-3">
        <div class="rounded-md bg-primary/10 p-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4" />
          </svg>
        </div>
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <h4 class="font-semibold text-foreground">NAPALM</h4>
            <span class="badge badge-info text-xs">Recommended</span>
          </div>
          <p class="text-xs text-muted-foreground mt-1">Multi-vendor network automation library with standardized APIs</p>
          <div class="mt-3 flex flex-wrap gap-1">
            <span class="badge badge-muted text-xs">get_facts</span>
            <span class="badge badge-muted text-xs">get_config</span>
            <span class="badge badge-muted text-xs">cli</span>
          </div>
        </div>
      </div>
    </button>

    <!-- Netmiko Card -->
    <button type="button" onclick="selectTaskType('netmiko')" class="task-type-card group relative rounded-lg border-2 border-border bg-card p-4 text-left hover:border-primary hover:bg-accent transition-all">
      <div class="flex items-start gap-3">
        <div class="rounded-md bg-primary/10 p-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
        </div>
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <h4 class="font-semibold text-foreground">Netmiko</h4>
          </div>
          <p class="text-xs text-muted-foreground mt-1">SSH-based CLI automation for network devices</p>
          <div class="mt-3 flex flex-wrap gap-1">
            <span class="badge badge-muted text-xs">send_command</span>
            <span class="badge badge-muted text-xs">send_config</span>
          </div>
        </div>
      </div>
    </button>

    <!-- Nornir Card -->
    <button type="button" onclick="selectTaskType('nornir')" class="task-type-card group relative rounded-lg border-2 border-border bg-card p-4 text-left hover:border-primary hover:bg-accent transition-all">
      <div class="flex items-start gap-3">
        <div class="rounded-md bg-primary/10 p-2">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
          </svg>
        </div>
        <div class="flex-1">
          <div class="flex items-center gap-2">
            <h4 class="font-semibold text-foreground">Nornir</h4>
            <span class="badge badge-warning text-xs">Advanced</span>
          </div>
          <p class="text-xs text-muted-foreground mt-1">Parallel task execution framework</p>
          <div class="mt-3 flex flex-wrap gap-1">
            <span class="badge badge-muted text-xs">custom_task</span>
            <span class="badge badge-muted text-xs">parallel</span>
          </div>
        </div>
      </div>
    </button>
  </div>

  <!-- Common Tasks Section -->
  <div class="mt-6">
    <h4 class="text-sm font-medium text-foreground mb-3">Common Tasks</h4>
    <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
      <button type="button" onclick="selectCommonTask('get_facts')" class="common-task-button rounded-md border border-input bg-background px-3 py-2 text-xs font-medium hover:bg-accent hover:text-accent-foreground transition-colors text-left">
        <div class="font-semibold">Get Facts</div>
        <div class="text-muted-foreground">Device info</div>
      </button>
      <button type="button" onclick="selectCommonTask('show_version')" class="common-task-button rounded-md border border-input bg-background px-3 py-2 text-xs font-medium hover:bg-accent hover:text-accent-foreground transition-colors text-left">
        <div class="font-semibold">Show Version</div>
        <div class="text-muted-foreground">Software version</div>
      </button>
      <button type="button" onclick="selectCommonTask('show_interfaces')" class="common-task-button rounded-md border border-input bg-background px-3 py-2 text-xs font-medium hover:bg-accent hover:text-accent-foreground transition-colors text-left">
        <div class="font-semibold">Show Interfaces</div>
        <div class="text-muted-foreground">Interface status</div>
      </button>
      <button type="button" onclick="selectCommonTask('backup_config')" class="common-task-button rounded-md border border-input bg-background px-3 py-2 text-xs font-medium hover:bg-accent hover:text-accent-foreground transition-colors text-left">
        <div class="font-semibold">Backup Config</div>
        <div class="text-muted-foreground">Save configuration</div>
      </button>
    </div>
  </div>

  <!-- Footer -->
  <div class="flex justify-end gap-2 pt-4 border-t">
    <button type="button" onclick="closeRunTaskWizard()" class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4">
      Cancel
    </button>
  </div>
</div>

<script>
let wizardData = {
  taskType: null,
  taskName: null,
  devices: getSelectedDeviceIds(),
  parameters: {}
};

function selectTaskType(type) {
  wizardData.taskType = type;
  loadWizardStep('task-selection');
}

function selectCommonTask(taskName) {
  // Map common tasks to their library
  const taskLibraryMap = {
    'get_facts': 'napalm',
    'show_version': 'netmiko',
    'show_interfaces': 'netmiko',
    'backup_config': 'napalm'
  };
  
  wizardData.taskType = taskLibraryMap[taskName];
  wizardData.taskName = taskName;
  loadWizardStep('parameters');
}
</script>
