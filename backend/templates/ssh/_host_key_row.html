<tr id="key-{{ key.id }}">
  <td class="px-6 py-4">
    <a href="/devices/{{ key.device.id }}/" class="font-medium text-blue-600 hover:text-blue-800">
      {{ key.device.hostname }}
    </a>
    <div class="text-sm text-muted-foreground">{{ key.device.mgmt_ip }}</div>
  </td>
  <td class="px-6 py-4">
    <span class="inline-flex items-center rounded-md px-2 py-1 text-xs font-medium bg-blue-50 text-blue-700 ring-1 ring-inset ring-blue-700/10">
      {{ key.get_key_type_display }}
    </span>
  </td>
  <td class="px-6 py-4">
    <code class="text-xs font-mono bg-muted px-2 py-1 rounded">{{ key.fingerprint_display|truncatechars:32 }}</code>
    <button type="button" onclick="navigator.clipboard.writeText('{{ key.fingerprint_display }}')" class="ml-2 text-muted-foreground hover:text-foreground" title="Copy fingerprint">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
      </svg>
    </button>
  </td>
  <td class="px-6 py-4 text-sm">
    {{ key.first_seen_at|date:"Y-m-d H:i" }}
  </td>
  <td class="px-6 py-4 text-sm">
    {{ key.last_seen_at|date:"Y-m-d H:i" }}
  </td>
  <td class="px-6 py-4">
    {% if key.verified %}
    <span class="inline-flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      Verified
    </span>
    <div class="text-xs text-muted-foreground mt-1">
      by {{ key.verified_by.username }} on {{ key.verified_at|date:"Y-m-d" }}
    </div>
    {% else %}
    <span class="inline-flex items-center gap-1.5 rounded-md px-2 py-1 text-xs font-medium bg-yellow-50 text-yellow-700 ring-1 ring-inset ring-yellow-600/20">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-3.5 w-3.5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
      </svg>
      Unverified
    </span>
    {% endif %}
  </td>
  <td class="px-6 py-4 text-right">
    <div class="flex items-center justify-end gap-2">
      {% if key.verified %}
      <button type="button"
              hx-post="{% url 'ssh-host-key-verify' key.id %}"
              hx-vals='{"action": "unverify"}'
              hx-target="#key-{{ key.id }}"
              hx-swap="outerHTML"
              class="inline-flex items-center justify-center gap-1.5 whitespace-nowrap rounded-lg text-xs font-medium h-8 px-3 text-foreground hover:bg-muted"
              title="Unverify key">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" />
        </svg>
        Unverify
      </button>
      {% else %}
      <button type="button"
              hx-post="{% url 'ssh-host-key-verify' key.id %}"
              hx-vals='{"action": "verify"}'
              hx-target="#key-{{ key.id }}"
              hx-swap="outerHTML"
              class="inline-flex items-center justify-center gap-1.5 whitespace-nowrap rounded-lg text-xs font-medium h-8 px-3 bg-green-600 text-white hover:bg-green-700"
              title="Verify key">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg>
        Verify
      </button>
      {% endif %}
      
      <button type="button"
              hx-delete="{% url 'ssh-host-key-delete' key.id %}"
              hx-target="#key-{{ key.id }}"
              hx-swap="outerHTML swap:0.5s"
              hx-confirm="Are you sure you want to delete this SSH host key?"
              class="inline-flex items-center justify-center gap-1.5 whitespace-nowrap rounded-lg text-xs font-medium h-8 px-3 text-red-600 hover:bg-red-50"
              title="Delete key">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
        </svg>
        Delete
      </button>
    </div>
  </td>
</tr>
