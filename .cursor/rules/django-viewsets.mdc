---
description: DRF ViewSet and serializer patterns
globs: ["**/api/**/*.py", "**/views.py", "**/serializers.py"]
alwaysApply: false
---

# DRF ViewSet Pattern

```python
from rest_framework import viewsets
from rest_framework.permissions import IsAuthenticated
from webnet.api.permissions import CustomerScopedQuerysetMixin, RolePermission

class MyViewSet(CustomerScopedQuerysetMixin, viewsets.ModelViewSet):
    queryset = MyModel.objects.all()
    serializer_class = MySerializer
    permission_classes = [IsAuthenticated, RolePermission]
    customer_field = "customer_id"  # or "parent__customer_id" for nested
    
    def perform_create(self, serializer: MySerializer) -> None:
        serializer.save(customer=self.get_customer())
```

# Serializer Pattern

```python
from rest_framework import serializers

class MySerializer(serializers.ModelSerializer):
    customer_name = serializers.CharField(source="customer.name", read_only=True)
    
    class Meta:
        model = MyModel
        fields = ["id", "name", "customer", "customer_name", "created_at"]
        read_only_fields = ["id", "created_at"]
```

**Rules:**
- Always use `CustomerScopedQuerysetMixin` for customer-scoped models
- Always use `RolePermission` on viewsets
- Set `customer_field` appropriately for nested relationships
